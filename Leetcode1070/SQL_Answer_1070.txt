WITH RANKED_YEAR 
AS 
(
SELECT *, rank() OVER (PARTITION BY product_id ORDER BY year) AS YEAR_RANK
FROM SALES
)
SELECT 
product_id, YEAR AS FIRST_YEAR, quantity, price 
FROM RANKED_YEAR
WHERE YEAR_RANK = 1